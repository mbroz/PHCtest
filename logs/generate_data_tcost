#!/bin/bash

function run() # $1 name $2 log $3 t_cost "$4" m_cost
{
	echo "[$(date --rfc-3339=seconds)] -- $2 / $1 --"
	PAR="-s 16 -i 32 -o 32"
	OUT=$2/$1.dat
	[ ! -d $2 ] && mkdir $2
	[ ! -f "$OUT" ] && echo "# in_len out_len m_cost t_cost time[ms] memory[kB]" > "$OUT"
	t_cost=$3
	for m_cost in $4 ; do
		../tst-$1 -f $OUT -w -r 3 $PAR -t $t_cost -m $m_cost
		echo -n "[$m_cost]"
	done
	echo "[$(date --rfc-3339=seconds)] --"
}

# Round table by Steve Thomas

# t_cost for 2x
run argon            mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon-aesni      mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d          mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d-sse      mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i          mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i-sse      mc_cost_2 2 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run battcrypt        mc_cost_2 0 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run catena-butterfly mc_cost_2 2 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run catena-dragonfly mc_cost_2 2 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run lyra2            mc_cost_2 2 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run lyra2-sse        mc_cost_2 2 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run pomelo           mc_cost_2 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run pomelo-sse       mc_cost_2 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
#run pufferfish      mc_cost_2 0 '7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23'
run yescrypt         mc_cost_2 3 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run yescrypt-sse     mc_cost_2 3 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'

# t_cost for 3x
run argon            mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon-aesni      mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d          mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d-sse      mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i          mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i-sse      mc_cost_3 3 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run battcrypt        mc_cost_3 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run catena-butterfly mc_cost_3 3 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run catena-dragonfly mc_cost_3 3 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run lyra2            mc_cost_3 3 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run lyra2-sse        mc_cost_3 3 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
#run pomelo          mc_cost_3 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20'
#run pomelo-sse      mc_cost_3 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20'
run pufferfish       mc_cost_3 0 '7 8 9 10 11 12 13 14 15 16 17 18 19 20' # 21 22 23'
run yescrypt         mc_cost_3 4 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18' # 19 20'
run yescrypt-sse     mc_cost_3 4 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18' # 19 20'

# t_cost for 4x
run argon            mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon-aesni      mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d          mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d-sse      mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i          mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i-sse      mc_cost_4 4 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run battcrypt        mc_cost_4 2 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run catena-butterfly mc_cost_4 4 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run catena-dragonfly mc_cost_4 4 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run lyra2            mc_cost_4 4 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run lyra2-sse        mc_cost_4 4 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run pomelo           mc_cost_4 2 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run pomelo-sse       mc_cost_4 2 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
#run pufferfish      mc_cost_4 0 '7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23'
run yescrypt         mc_cost_4 5 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run yescrypt-sse     mc_cost_4 5 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'

# t_cost for 5x
run argon            mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon-aesni      mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d          mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2d-sse      mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i          mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
run argon2i-sse      mc_cost_5 5 '128 256 512 1024 2048 4096 8192 16384 32768 65535 131072 262144 524288 1048576' # 2097152 4194304 8388608'
#run battcrypt       mc_cost_5 0 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20'
run catena-butterfly mc_cost_5 5 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run catena-dragonfly mc_cost_5 5 '11 12 13 14 15 16 17 18 19 20 21 22 23 24' # 25 26 27'
run lyra2            mc_cost_5 5 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
run lyra2-sse        mc_cost_5 5 '5 11 21 43 85 171 341 683 1365 2731 5461 10923 21845 43691' # 87381 174763 349525'
#run pomelo          mc_cost_5 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20'
#run pomelo-sse      mc_cost_5 1 '4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20'
run pufferfish       mc_cost_5 1 '7 8 9 10 11 12 13 14 15 16 17 18 19 20' # 21 22 23'
run yescrypt         mc_cost_5 6 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
run yescrypt-sse     mc_cost_5 6 '4 5 6 7 8 9 10 11 12 13 14 15 16 17' # 18 19 20'
